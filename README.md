# Building Area Estimation from Aerial Imagery

![Python](https://img.shields.io/badge/Python-3.12+-blue.svg)
![PyTorch](https://img.shields.io/badge/PyTorch-2.9+-red.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)

–û—Ü–µ–Ω–∫–∞ –ø–ª–æ—â–∞–¥–∏ –∑–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö –∏ –∞—ç—Ä–æ—Ñ–æ—Ç–æ—Å–Ω–∏–º–∫–∞—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–æ–≤ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –¥–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤).

---

## –û –ø—Ä–æ–µ–∫—Ç–µ

–ò—Ç–æ–≥–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∫—É—Ä—Å–∞ [Deep Learning School](https://dls.samcs.ru/) (–ú–§–¢–ò) ‚Äî [Stepik](https://stepik.org/course/250969/).

–ü—Ä–æ–µ–∫—Ç —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ü–µ–Ω–∫–∏ –ø–ª–æ—â–∞–¥–∏ –∑–∞—Å—Ç—Ä–æ–π–∫–∏ (–≤ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö –º–µ—Ç—Ä–∞—Ö) –ø–æ –∞—ç—Ä–æ—Ñ–æ—Ç–æ—Å–Ω–∏–º–∫–∞–º –∏ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –¥–≤–∞ –ø–æ–¥—Ö–æ–¥–∞ –∫ —Ä–µ—à–µ–Ω–∏—é –∑–∞–¥–∞—á–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è:

- **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è** ‚Äî UNet —Å ResNet-50 —ç–Ω–∫–æ–¥–µ—Ä–æ–º
- **–î–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤** ‚Äî Faster R-CNN —Å Feature Pyramid Network

**–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**

- –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø—É—Ç–Ω–∏–∫–æ–≤–æ–≥–æ —Å–Ω–∏–º–∫–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–ª–æ—â–∞–¥–∏ –∑–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –º¬≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (GSD) —Å –ø–æ–º–æ—â—å—é –Ω–µ–π—Ä–æ—Å–µ—Ç–∏
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Å–∫–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –Ω–∞–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- –ü–æ–¥—Å—á—ë—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–¥–∞–Ω–∏–π –∏ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –∑–∞—Å—Ç—Ä–æ–π–∫–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ (tiling mode)

---

## –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è

–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –±–∞–∑–µ Gradio –ø–æ–∑–≤–æ–ª—è–µ—Ç:

1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–π —Å–Ω–∏–º–æ–∫ (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç—ã TIFF, PNG, JPEG)
2. –í—ã–±—Ä–∞—Ç—å —Ä–µ–∂–∏–º –æ–±—Ä–∞–±–æ—Ç–∫–∏:
   - **Tiling (Accurate)** ‚Äî –Ω–∞—Ä–µ–∑–∫–∞ –Ω–∞ —Ç–∞–π–ª—ã 512x512, —Ç–æ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
   - **Resize (Fast)** ‚Äî –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, –±—ã—Å—Ç—Ä—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
3. –£–∫–∞–∑–∞—Ç—å GSD –≤—Ä—É—á–Ω—É—é –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (–∫–Ω–æ–ø–∫–∞ "Calculate Scale")
4. –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
   - –ë–∏–Ω–∞—Ä–Ω—É—é –º–∞—Å–∫—É —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
   - –ù–∞–ª–æ–∂–µ–Ω–∏–µ –º–∞—Å–∫–∏ –Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
   - –ü–ª–æ—â–∞–¥—å –∑–∞—Å—Ç—Ä–æ–π–∫–∏ (–º¬≤), –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–∫—Ä—ã—Ç–∏—è, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–¥–∞–Ω–∏–π

**Hugging Face Spaces:** [MindForgeTim/dls-geo](https://huggingface.co/spaces/MindForgeTim/dls-geo)

**–ú–æ–¥–µ–ª–∏ –Ω–∞ HuggingFace Hub:**

| –ú–æ–¥–µ–ª—å | –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-------------|----------|
| –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è | [MindForgeTim/building-segmentation](https://huggingface.co/MindForgeTim/building-segmentation) | UNet —Å ResNet-50 —ç–Ω–∫–æ–¥–µ—Ä–æ–º |
| –î–µ—Ç–µ–∫—Ü–∏—è | [MindForgeTim/building-detection](https://huggingface.co/MindForgeTim/building-detection) | Faster R-CNN —Å Feature Pyramid Network |
| GSD Estimation | [MindForgeTim/dls-gsd-model](https://huggingface.co/MindForgeTim/dls-gsd-model) | RegressionTreeCNN (ResNet-101) |

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.12+
- [uv](https://docs.astral.sh/uv/) ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ Python

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/timur-ai/dls-1-geo.git
cd dls-1-geo
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
uv sync
```

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
cd app
uv run python app.py
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:7860`

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
uv run pytest
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
dls_project/
‚îú‚îÄ‚îÄ app/                          # Gradio –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∞–≤—Ç–æ–Ω–æ–º–Ω–æ–µ)
‚îÇ   ‚îú‚îÄ‚îÄ app.py                    # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ config.py                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ø—É—Ç–∏, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
‚îÇ   ‚îú‚îÄ‚îÄ inference.py              # –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –º–æ–¥–µ–ª–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ preprocessing.py          # –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ postprocessing.py         # –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Å–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ gsd_model.py              # –ò–Ω—Ñ–µ—Ä–µ–Ω—Å GSD –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è HF Spaces
‚îÇ   ‚îú‚îÄ‚îÄ README.md                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è HF Spaces
‚îÇ   ‚îú‚îÄ‚îÄ models/                   # –õ–æ–∫–∞–ª—å–Ω—ã–µ –∫–æ–ø–∏–∏ –º–æ–¥–µ–ª–µ–π (–¥–ª—è –¥–µ–ø–ª–æ—è)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ unet.py               # UNet —Å ResNet-50 —ç–Ω–∫–æ–¥–µ—Ä–æ–º
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ gsd.py                # Regression Tree CNN (GSD)
‚îÇ   ‚îî‚îÄ‚îÄ examples/                 # –ü—Ä–∏–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –¥–µ–º–æ
‚îÇ
‚îú‚îÄ‚îÄ src/                          # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –º–æ–¥–µ–ª–µ–π –∏ —É—Ç–∏–ª–∏—Ç
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ unet.py               # UNet —Å ResNet-50 —ç–Ω–∫–æ–¥–µ—Ä–æ–º
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ faster_rcnn.py        # Faster R-CNN —Å FPN
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ gsd.py                # Regression Tree CNN (GSD)
‚îÇ   ‚îú‚îÄ‚îÄ datasets/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inria_dataset.py      # Dataset –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inria_detection_dataset.py  # Dataset –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ transforms.py         # –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (Albumentations)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ bbox_utils.py         # –£—Ç–∏–ª–∏—Ç—ã bounding boxes
‚îÇ   ‚îú‚îÄ‚îÄ losses/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dice_loss.py          # Dice Loss
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ focal_loss.py         # Focal Loss
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ combined_loss.py      # BCE+Dice, Focal+Dice
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ giou_loss.py          # GIoU Loss (–¥–µ—Ç–µ–∫—Ü–∏—è)
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ metrics.py            # –ú–µ—Ç—Ä–∏–∫–∏ (IoU, mAP)
‚îÇ       ‚îú‚îÄ‚îÄ area.py               # –†–∞—Å—á—ë—Ç –ø–ª–æ—â–∞–¥–∏
‚îÇ       ‚îú‚îÄ‚îÄ checkpoint.py         # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π
‚îÇ       ‚îú‚îÄ‚îÄ seed.py               # –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å
‚îÇ       ‚îî‚îÄ‚îÄ visualization.py      # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ notebooks/                               # Jupyter notebooks —Å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ 01_eda_aerial_dataset.ipynb          # –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ 02_generate_test_ground_truth.ipynb  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞—Å–æ–∫ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ 03_gsd_estimation_training.ipynb     # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∞
‚îÇ   ‚îú‚îÄ‚îÄ 04_segmentation_training.ipynb       # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ 05_detection_training.ipynb          # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ data/                         # –î–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ raw/                      # INRIA Aerial Image Labeling Dataset
‚îÇ   ‚îú‚îÄ‚îÄ processed/test/gt/        # –ê–≤—Ç–æ—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ checkpoints/                  # –í–µ—Å–∞ –º–æ–¥–µ–ª–µ–π –∏ –º–µ—Ç—Ä–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ segmentation/             # UNet: –≤–µ—Å–∞, –∫—Ä–∏–≤—ã–µ –æ–±—É—á–µ–Ω–∏—è, –º–µ—Ç—Ä–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ detection/                # Faster R-CNN: –≤–µ—Å–∞, –∫—Ä–∏–≤—ã–µ, –∏—Å—Ç–æ—Ä–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ GSD/                      # GSD model: –≤–µ—Å–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ü–µ–Ω–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ docs/                               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ AerialImageLabelingDataset.pdf  # –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ INRIA
‚îÇ   ‚îú‚îÄ‚îÄ Estimation of GSD.pdf           # –°—Ç–∞—Ç—å—è –ø–æ –æ—Ü–µ–Ω–∫–µ GSD
‚îÇ   ‚îú‚îÄ‚îÄ dataset_description.md          # Markdown –æ–ø–∏—Å–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ requirements.md                 # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –∫ –ø—Ä–æ–µ–∫—Ç—É
‚îÇ   ‚îî‚îÄ‚îÄ notes.md                        # –ü–æ—è—Å–Ω–µ–Ω–∏—è –∫ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É –∑–∞–¥–∞–Ω–∏—é –Ω–∞ stepik.org
‚îÇ
‚îú‚îÄ‚îÄ tests/                        # Unit-—Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ test_inference.py         # –¢–µ—Å—Ç—ã –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ test_postprocessing.py    # –¢–µ—Å—Ç—ã –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ test_preprocessing.py     # –¢–µ—Å—Ç—ã –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ pyproject.toml                # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (uv)
‚îî‚îÄ‚îÄ uv.lock                       # Lock-—Ñ–∞–π–ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```

---

## –î–∞—Ç–∞—Å–µ—Ç

### INRIA Aerial Image Labeling Dataset

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç [INRIA Aerial Image Labeling Dataset](https://project.inria.fr/aerialimagelabeling/) ‚Äî –∫—Ä—É–ø–Ω—ã–π –ø—É–±–ª–∏—á–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –∑–∞–¥–∞—á–∏ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∑–¥–∞–Ω–∏–π –Ω–∞ –∞—ç—Ä–æ—Ñ–æ—Ç–æ—Å–Ω–∏–º–∫–∞—Ö.

| –ü–∞—Ä–∞–º–µ—Ç—Ä                          | –ó–Ω–∞—á–µ–Ω–∏–µ                |
| --------------------------------- | ----------------------- |
| –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π      | 360                     |
| –†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è                | 5000 x 5000 –ø–∏–∫—Å–µ–ª–µ–π    |
| –§–æ—Ä–º–∞—Ç                            | GeoTIFF (RGB)           |
| –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ (GSD) | 30 —Å–º/–ø–∏–∫—Å–µ–ª—å           |
| –ü–ª–æ—â–∞–¥—å –æ–¥–Ω–æ–≥–æ —Å–Ω–∏–º–∫–∞             | 1.5 x 1.5 –∫–º (2.25 –∫–º¬≤) |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Ä–æ–¥–æ–≤                | 10 (–°–®–ê, –ê–≤—Å—Ç—Ä–∏—è)       |

### –†–∞–∑–±–∏–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

| –í—ã–±–æ—Ä–∫–∞    | –ì–æ—Ä–æ–¥–∞                                                     | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ   |
| ---------- | ---------------------------------------------------------- | ----------- | ------------ |
| Train      | Austin, Chicago, Kitsap, Tyrol-W, Vienna                   | 155         | –û–±—É—á–µ–Ω–∏–µ     |
| Validation | Austin, Chicago, Kitsap, Tyrol-W, Vienna (—Ç–∞–π–ª—ã 1-5)       | 25          | –í–∞–ª–∏–¥–∞—Ü–∏—è    |
| Test       | Bellingham, Bloomington, Innsbruck, San Francisco, Tyrol-E | 180 (50\*)  | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |

\* –í —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ 180 —Å–Ω–∏–º–∫–æ–≤, –Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–º–µ—á–µ–Ω–æ —Ç–æ–ª—å–∫–æ 50 (—Å–∫—Ä–∏–ø—Ç `02_generate_test_ground_truth.ipynb`).

**–í–∞–∂–Ω–æ:** –ì–æ—Ä–æ–¥–∞ –≤ train –∏ test –≤—ã–±–æ—Ä–∫–∞—Ö –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –∫ –æ–±–æ–±—â–µ–Ω–∏—é –Ω–∞ –Ω–æ–≤—ã–µ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ä–µ–≥–∏–æ–Ω—ã.

### –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞

–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ INRIA –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç ground truth –º–∞—Å–æ–∫. –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Å–∫–∏ —Å –ø–æ–º–æ—â—å—é –∞–Ω—Å–∞–º–±–ª—è **SAM2 + YOLOv8** (50 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π).

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ pretrained –º–æ–¥–µ–ª–µ–π (–≤–∫–ª—é—á–∞—è YOLO –æ—Ç Ultralytics) –¥–ª—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á (–∞–≤—Ç–æ—Ä–∞–∑–º–µ—Ç–∫–∞, —Ä–∞—Å—á—ë—Ç GSD) —Ä–∞–∑—Ä–µ—à–µ–Ω–æ —É—Å–ª–æ–≤–∏—è–º–∏ –∑–∞–¥–∞–Ω–∏—è. Training loop —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.

### –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞

```bash
# –°–∫–∞—á–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞
wget https://files.inria.fr/aerialimagelabeling/aerialimagelabeling.7z.001
wget https://files.inria.fr/aerialimagelabeling/aerialimagelabeling.7z.002
wget https://files.inria.fr/aerialimagelabeling/aerialimagelabeling.7z.003
wget https://files.inria.fr/aerialimagelabeling/aerialimagelabeling.7z.004
wget https://files.inria.fr/aerialimagelabeling/aerialimagelabeling.7z.005

# –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å
7z x aerialimagelabeling.7z.001 -o./data/raw/
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–µ–π

### 1. UNet —Å ResNet-50 —ç–Ω–∫–æ–¥–µ—Ä–æ–º (—Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è)

–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ UNet —Å pretrained ResNet-50 –≤ –∫–∞—á–µ—Å—Ç–≤–µ —ç–Ω–∫–æ–¥–µ—Ä–∞:

- **–≠–Ω–∫–æ–¥–µ—Ä:** ResNet-50 (ImageNet pretrained), –∏–∑–≤–ª–µ–∫–∞–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–∞ 5 –º–∞—Å—à—Ç–∞–±–∞—Ö
- **–î–µ–∫–æ–¥–µ—Ä:** –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–≤—ë—Ä—Ç–∫–∏ + skip connections
- **–í—ã—Ö–æ–¥:** –ë–∏–Ω–∞—Ä–Ω–∞—è –º–∞—Å–∫–∞ (1 –∫–∞–Ω–∞–ª, sigmoid)
- **–í—Ö–æ–¥:** RGB –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 512x512

```
Input (3, 512, 512)
  ‚Üí ResNet Encoder (5 scales: 64‚Üí256‚Üí512‚Üí1024‚Üí2048 channels)
  ‚Üí Decoder with skip connections
  ‚Üí Output (1, 512, 512)
```

### 2. Faster R-CNN —Å FPN (–¥–µ—Ç–µ–∫—Ü–∏—è)

–î–≤—É—Ö—Å—Ç–∞–¥–∏–π–Ω—ã–π –¥–µ—Ç–µ–∫—Ç–æ—Ä –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∑–¥–∞–Ω–∏–π:

- **Backbone:** ResNet-50 —Å Feature Pyramid Network
- **RPN:** Region Proposal Network –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
- **–ö–ª–∞—Å—Å—ã:** 2 (background + building)
- **NMS threshold:** 0.5
- **Score threshold:** 0.05 (training), 0.5 (inference)

### 3. Regression Tree CNN (–æ—Ü–µ–Ω–∫–∞ GSD)

–ú–æ–¥–µ–ª—å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (Ground Sampling Distance):

- **Backbone:** ResNet-101 (pretrained)
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** Binomial Tree Layer (Lee & Sull, 2019)
- **–í—ã—Ö–æ–¥:** GSD –≤ —Å–º/–ø–∏–∫—Å–µ–ª—å
- **–§–æ—Ä–º—É–ª–∞:** `GSD = 20 * mantissa * 2^exponent`
  - exponent: –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (5 –∫–ª–∞—Å—Å–æ–≤: 0-4)
  - mantissa: —Ä–µ–≥—Ä–µ—Å—Å–∏—è [0.75, 1.5]
- **–î–∏–∞–ø–∞–∑–æ–Ω:** 15-480 —Å–º/–ø–∏–∫—Å–µ–ª—å

---

## –û–±—É—á–µ–Ω–∏–µ

### Loss-—Ñ—É–Ω–∫—Ü–∏–∏

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ loss-—Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –±–æ—Ä—å–±—ã —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤ (—Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ñ–æ–Ω:–∑–¥–∞–Ω–∏—è ~ 5:1):

| Loss             | –§–æ—Ä–º—É–ª–∞                | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                      |
| ---------------- | ---------------------- | ----------------------------------------------- |
| **BCE + Dice**   | `0.5*BCE + 0.5*Dice`   | –û—Å–Ω–æ–≤–Ω–∞—è –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏                        |
| **Focal + Dice** | `0.5*Focal + 0.5*Dice` | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ —Å —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∫–æ–π –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö |
| **GIoU Loss**    | Generalized IoU        | –î–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ (—Ä–µ–≥—Ä–µ—Å—Å–∏—è bbox)                   |

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞:**
- **BCE** –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ø–∏–∫—Å–µ–ª—å–Ω—É—é —Ç–æ—á–Ω–æ—Å—Ç—å
- **Dice** –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç overlap/area –º–µ—Ç—Ä–∏–∫—É, —É—Å—Ç–æ–π—á–∏–≤ –∫ –¥–∏—Å–±–∞–ª–∞–Ω—Å—É
- **Focal** (gamma=2, alpha=0.25) —Å–Ω–∏–∂–∞–µ—Ç –≤–µ—Å –ª–µ–≥–∫–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤

### –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä      | –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è (UNet) | –î–µ—Ç–µ–∫—Ü–∏—è (Faster R-CNN) |
| ------------- | ------------------ | ----------------------- |
| Optimizer     | AdamW              | SGD (momentum=0.9)      |
| Learning rate | 1e-4               | 0.005                   |
| Weight decay  | 1e-4               | 5e-4                    |
| Batch size    | 8                  | 4                       |
| Epochs        | 30                 | 100                     |
| Scheduler     | ReduceLROnPlateau  | StepLR (step=30)        |
| Tile size     | 512x512            | 800-1333 (dynamic)      |

### Jupyter Notebooks

–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ notebooks:

| Notebook                              | –û–ø–∏—Å–∞–Ω–∏–µ                             |
| ------------------------------------- | ------------------------------------ |
| `01_eda_aerial_dataset.ipynb`         | –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞    |
| `02_generate_test_ground_truth.ipynb` | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –º–∞—Å–æ–∫ (SAM2+YOLO) |
| `03_gsd_estimation_training.ipynb`    | –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –æ—Ü–µ–Ω–∫–∏ GSD           |
| `04_segmentation_training.ipynb`      | –û–±—É—á–µ–Ω–∏–µ UNet –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏        |
| `05_detection_training.ipynb`         | –û–±—É—á–µ–Ω–∏–µ Faster R-CNN –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏   |

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è (UNet)

| –ú–µ—Ç—Ä–∏–∫–∞        | –ó–Ω–∞—á–µ–Ω–∏–µ   |
| -------------- | ---------- |
| **Mean IoU**   | **73.71%** |
| Mean Dice      | 84.86%     |
| MAPE (–ø–ª–æ—â–∞–¥—å) | 6.13%      |
| MAE (–ø–ª–æ—â–∞–¥—å)  | 12,401 m¬≤  |

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –≥–æ—Ä–æ–¥–∞–º (validation):**

| –ì–æ—Ä–æ–¥   | IoU    | Error % |
| ------- | ------ | ------- |
| Austin  | 78.74% | 1.42%   |
| Chicago | 69.75% | 7.55%   |
| Kitsap  | 61.38% | 18.21%  |
| Tyrol-W | 79.49% | 1.36%   |
| Vienna  | 79.20% | 2.10%   |

### –î–µ—Ç–µ–∫—Ü–∏—è (Faster R-CNN)

| –ú–µ—Ç—Ä–∏–∫–∞            | –ó–Ω–∞—á–µ–Ω–∏–µ   |
| ------------------ | ---------- |
| **Best mAP@50**    | **47.79%** |
| Final mAP@50       | 47.60%     |
| Epochs to converge | ~25        |

### –û—Ü–µ–Ω–∫–∞ GSD (Regression Tree CNN)

| –ú–µ—Ç—Ä–∏–∫–∞           | –ó–Ω–∞—á–µ–Ω–∏–µ         |
| ----------------- | ---------------- |
| MAE               | 50.43 —Å–º/–ø–∏–∫—Å–µ–ª—å |
| Median AE         | 25.98 —Å–º/–ø–∏–∫—Å–µ–ª—å |
| RMSE              | 81.03 —Å–º/–ø–∏–∫—Å–µ–ª—å |
| Exponent Accuracy | 53.72%           |

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

| –ü–æ–¥—Ö–æ–¥          | –ü–ª—é—Å—ã                                                  | –ú–∏–Ω—É—Å—ã                          |
| --------------- | ------------------------------------------------------ | ------------------------------- |
| **–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è** | –í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç—É—Ä–æ–≤, –ª—É—á—à–µ –¥–ª—è –ø–ª–æ—Ç–Ω–æ–π –∑–∞—Å—Ç—Ä–æ–π–∫–∏ | –ù–µ —Ä–∞–∑–¥–µ–ª—è–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–¥–∞–Ω–∏—è   |
| **–î–µ—Ç–µ–∫—Ü–∏—è**    | –ü–æ–¥—Å—á—ë—Ç –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–¥–∞–Ω–∏–π, bbox –¥–ª—è –∫–∞–∂–¥–æ–≥–æ             | –•—É–∂–µ –Ω–∞ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏—Ö—Å—è –∑–¥–∞–Ω–∏—è—Ö |

**–í—ã–≤–æ–¥:** –î–ª—è –∑–∞–¥–∞—á–∏ –æ—Ü–µ–Ω–∫–∏ –ø–ª–æ—â–∞–¥–∏ –∑–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (IoU 73.71% vs mAP@50 47.79%). –î–µ—Ç–µ–∫—Ü–∏—è –ø–æ–ª–µ–∑–Ω–∞ –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–¥–∞–Ω–∏–π.

---

## –†–∞—Å—á—ë—Ç –ø–ª–æ—â–∞–¥–∏ –∏ –º–∞—Å—à—Ç–∞–±–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

### –ß—Ç–æ —Ç–∞–∫–æ–µ GSD?

**GSD (Ground Sampling Distance)** ‚Äî –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —Ä–∞–∑–º–µ—Ä –æ–¥–Ω–æ–≥–æ –ø–∏–∫—Å–µ–ª—è –Ω–∞ –∑–µ–º–ª–µ –≤ –º–µ—Ç—Ä–∞—Ö.

- –î–ª—è –¥–∞—Ç–∞—Å–µ—Ç–∞ INRIA: GSD = 0.3 –º/–ø–∏–∫—Å–µ–ª—å (30 —Å–º)
- –ü–ª–æ—â–∞–¥—å –æ–¥–Ω–æ–≥–æ –ø–∏–∫—Å–µ–ª—è = GSD¬≤ = 0.09 –º¬≤

### –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á—ë—Ç–∞ –ø–ª–æ—â–∞–¥–∏

```
–ü–ª–æ—â–∞–¥—å (–º¬≤) = –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–∏–∫—Å–µ–ª–µ–π_–∑–¥–∞–Ω–∏–π √ó GSD¬≤
```

**–ü—Ä–∏–º–µ—Ä:** –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –Ω–∞—à–ª–∞ 50,000 –ø–∏–∫—Å–µ–ª–µ–π –∑–¥–∞–Ω–∏–π –ø—Ä–∏ GSD = 0.3 –º:
```
S = 50,000 √ó 0.3¬≤ = 50,000 √ó 0.09 = 4,500 –º¬≤
```

### –ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å GSD –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è?

| –°–ø–æ—Å–æ–±                  | –û–ø–∏—Å–∞–Ω–∏–µ                                    | –¢–æ—á–Ω–æ—Å—Ç—å                |
| ----------------------- | ------------------------------------------- | ----------------------- |
| **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ GeoTIFF**  | GSD –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ –≥–µ–æ–ø—Ä–∏–≤—è–∑–∫–∏              | –í—ã—Å–æ–∫–∞—è                 |
| **–ò–∑–≤–µ—Å—Ç–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫**  | –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π GSD —Å–ø—É—Ç–Ω–∏–∫–∞/–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã    | –í—ã—Å–æ–∫–∞—è                 |
| **–ù–µ–π—Ä–æ—Å–µ—Ç–µ–≤–∞—è –æ—Ü–µ–Ω–∫–∞** | Regression Tree CNN –ø–æ –≤–∏–∑—É–∞–ª—å–Ω—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º | –°—Ä–µ–¥–Ω—è—è                 |
| **–í–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**   | –†—É—á–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ GSD                         | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

### –í—Å–µ–≥–¥–∞ –ª–∏ –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–∞—Å—à—Ç–∞–±?

**–ù–µ—Ç, –Ω–µ –≤—Å–µ–≥–¥–∞.** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ GSD –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–ª–∏ –∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–æ, –µ—Å–ª–∏:

- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏
- –ò—Å—Ç–æ—á–Ω–∏–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—ã–ª–æ –æ–±—Ä–µ–∑–∞–Ω–æ –∏–ª–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–æ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–π
- –°–Ω–∏–º–æ–∫ —Å–¥–µ–ª–∞–Ω –ø–æ–¥ —É–≥–ª–æ–º (–Ω–µ –Ω–∞–¥–∏—Ä)

**–†–µ—à–µ–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ:**

1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞ GSD –Ω–µ–π—Ä–æ—Å–µ—Ç—å—é (–∫–Ω–æ–ø–∫–∞ "Calculate Scale")
2. –†—É—á–Ω–æ–π –≤–≤–æ–¥ GSD –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
3. –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (0.3 –º)

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

–í Gradio-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:
- –ü–æ–ª–µ "GSD (m/px)" –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞
- –ö–Ω–æ–ø–∫–∞ "Calculate Scale" –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ü–µ–Ω–∫–∏
- –ú–æ–¥–µ–ª—å `RegressionTreeCNN` —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 15-480 —Å–º/–ø–∏–∫—Å–µ–ª—å

---

## –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Hugging Face Spaces

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ Space

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [Hugging Face Spaces](https://huggingface.co/spaces)
2. –ù–∞–∂–º–∏—Ç–µ "New Space"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
   - **Owner:** –≤–∞—à username
   - **Space name:** `dls-geo`
   - **License:** MIT
   - **SDK:** Gradio
   - **Hardware:** CPU Basic (–±–µ—Å–ø–ª–∞—Ç–Ω–æ) –∏–ª–∏ GPU T4 (–¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è)
4. –ù–∞–∂–º–∏—Ç–µ "Create Space"

### –®–∞–≥ 2: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –¥–ª—è Spaces

```
aerial-building-analysis/
‚îú‚îÄ‚îÄ app.py                # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ config.py             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ inference.py          # –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ preprocessing.py      # –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞
‚îú‚îÄ‚îÄ postprocessing.py     # –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞
‚îú‚îÄ‚îÄ gsd_model.py          # GSD –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ models/               # –õ–æ–∫–∞–ª—å–Ω—ã–µ –∫–æ–ø–∏–∏ –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ unet.py           # UNet –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ gsd.py            # GSD –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
‚îú‚îÄ‚îÄ examples/             # –ü—Ä–∏–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îú‚îÄ‚îÄ requirements.txt      # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Space (YAML)
```

> –ì–æ—Ç–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –¥–µ–ø–ª–æ—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ `app/`

### –®–∞–≥ 3: README.md –¥–ª—è Space (YAML front matter)

–°–æ–∑–¥–∞–π—Ç–µ `README.md` —Å YAML-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞:

```yaml
---
title: Aerial Building Analysis
emoji: üè¢
colorFrom: gray
colorTo: blue
sdk: gradio
sdk_version: "6.3.0"
python_version: "3.12"
app_file: app.py
license: mit
models:
  - MindForgeTim/building-segmentation
  - MindForgeTim/dls-gsd-model
tags:
  - segmentation
  - aerial-imagery
  - buildings
pinned: false
---

# Aerial Building Analysis

Automatic building segmentation and area estimation from aerial/satellite imagery.
```

### –®–∞–≥ 4: requirements.txt –¥–ª—è Spaces

```
torch>=2.0.0
torchvision>=0.15.0
gradio>=6.0.0
numpy>=1.24.0
opencv-python-headless>=4.8.0
albumentations>=1.3.0
timm>=0.9.0
huggingface-hub>=0.20.0
scikit-image>=0.21.0
```

**–í–∞–∂–Ω–æ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `opencv-python-headless` –≤–º–µ—Å—Ç–æ `opencv-python` –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

> –ê–∫—Ç—É–∞–ª—å–Ω—ã–π `requirements.txt` –¥–ª—è –¥–µ–ø–ª–æ—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `app/requirements.txt`

### –®–∞–≥ 5: –ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏

–í–∞—Ä–∏–∞–Ω—Ç—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–µ—Å–æ–≤:

| –°–ø–æ—Å–æ–±   | –û–ø–∏—Å–∞–Ω–∏–µ                   | –õ–∏–º–∏—Ç       |
| -------- | -------------------------- | ----------- |
| –í Space  | –§–∞–π–ª—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ Space  | –¥–æ 10 GB    |
| HF Hub   | –û—Ç–¥–µ–ª—å–Ω—ã–π Model repository | –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω |

**–ü—Ä–∏–º–µ—Ä –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏:**

```python
from huggingface_hub import hf_hub_download

# –ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Å–æ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
checkpoint_path = hf_hub_download(
    repo_id="username/building-segmentation-weights",
    filename="unet_resnet50.pth"
)
```

### –®–∞–≥ 6: –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Git

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å Space
git clone https://huggingface.co/spaces/username/dls-geo
cd dls-geo

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
cp -r /path/to/project/app/* .

# –°–æ–∑–¥–∞—Ç—å requirements.txt (—Å–º. —à–∞–≥ 4)

# –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏ –∑–∞–ø—É—à–∏—Ç—å
git add .
git commit -m "Initial deployment"
git push
```

–ü–æ—Å–ª–µ push Hugging Face –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–µ—Ä—ë—Ç –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

### –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ø–ª–æ—è

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É Space: `https://huggingface.co/spaces/username/dls-geo`
2. –î–æ–∂–¥–∏—Ç–µ—Å—å —Å—Ç–∞—Ç—É—Å–∞ "Running" (—Å–±–æ—Ä–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 2-5 –º–∏–Ω—É—Ç)
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–æ–∫ (–≤–∫–ª–∞–¥–∫–∞ "Logs")

### Troubleshooting

| –ü—Ä–æ–±–ª–µ–º–∞        | –†–µ—à–µ–Ω–∏–µ                                                       |
| --------------- | ------------------------------------------------------------- |
| Out of Memory   | –£–º–µ–Ω—å—à–∏—Ç—å batch size, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GPU hardware               |
| Import Error    | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å requirements.txt, –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –ø–∞–∫–µ—Ç—ã       |
| Model not found | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—Ç–∏ –∫ –≤–µ—Å–∞–º, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å hf_hub_download          |
| Timeout         | –£–≤–µ–ª–∏—á–∏—Ç—å —Ç–∞–π–º–∞—É—Ç –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Space, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–µ—Ä–µ–Ω—Å |

---

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏

–ü—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ —Ä–∞–º–∫–∞—Ö –∏—Ç–æ–≥–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –∫—É—Ä—Å–∞ Deep Learning School.

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∏–∑ –¢–ó (–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω—ã –∫ 12 –±–∞–ª–ª–∞–º)

| –ö—Ä–∏—Ç–µ—Ä–∏–π                                                   | –ë–∞–ª–ª—ã    | –°—Ç–∞—Ç—É—Å    |
| ---------------------------------------------------------- | -------- | --------- |
| –ö–∞—Å—Ç–æ–º–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –∏ –¥–∞—Ç–∞–ª–æ–∞–¥–µ—Ä, –∑–∞–≥—Ä—É–∑–∫–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏ | 0.5      | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –∏ —Ä–∞–∑–º–µ—á–µ–Ω–∞ —Ç–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞   | 1.0      | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –í—ã–±–æ—Ä —Ç–∏–ø–∞ —Ä–µ—à–∞–µ–º–æ–π –∑–∞–¥–∞—á–∏, –º–æ–¥–µ–ª–∏, –º–µ—Ç—Ä–∏–∫ –∏ –µ—ë –æ–±—É—á–µ–Ω–∏–µ   | 2.0      | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –†–µ—à–µ–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–π –∑–∞–¥–∞—á–∏ (—Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è + –¥–µ—Ç–µ–∫—Ü–∏—è)     | 2.0      | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å –∫–æ–º–±–∏–Ω–∞—Ü–∏–µ–π –±–æ–ª–µ–µ —á–µ–º –∏–∑ –æ–¥–Ω–æ–≥–æ –ª–æ—Å—Å–∞    | 2.0      | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ                               | 0.5      | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–º–æ-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ Streamlit –∏–ª–∏ Gradio         | 2.0      | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –í—ã–≤–æ–¥—ã –ø–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é                                     | 1.0      | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –ß–∏—Å—Ç–æ—Ç–∞ –∫–æ–¥–∞ –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ—Å—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è         | 1.0      | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| **–ò—Ç–æ–≥–æ**                                                  | **12.0** | ‚Äî         |

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é Ultralytics:** –°–æ–≥–ª–∞—Å–Ω–æ –¢–ó, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤—ã—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (Ultralytics, MMDet) –∑–∞–ø—Ä–µ—â–µ–Ω–æ ‚Äî training loop —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ. –û–¥–Ω–∞–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å pretrained –º–æ–¥–µ–ª–∏ –¥–ª—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á. –í –ø—Ä–æ–µ–∫—Ç–µ YOLO –∏ SAM2 –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ground truth –º–∞—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏.

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

| –ö—Ä–∏—Ç–µ—Ä–∏–π                                                                 | –ë–∞–ª–ª—ã    | –°—Ç–∞—Ç—É—Å    |
| ------------------------------------------------------------------------ | -------- | --------- |
| –ö–∞—Å—Ç–æ–º–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –∏ –¥–∞—Ç–∞–ª–æ–∞–¥–µ—Ä, –∑–∞–≥—Ä—É–∑–∫–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏               | 1        | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –∏ —Ä–∞–∑–º–µ—á–µ–Ω–∞ —Ç–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞                 | 2        | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –í—ã–±–æ—Ä —Ç–∏–ø–∞ —Ä–µ—à–∞–µ–º–æ–π –∑–∞–¥–∞—á–∏, –º–æ–¥–µ–ª–∏, –º–µ—Ç—Ä–∏–∫ –∏ –µ—ë –æ–±—É—á–µ–Ω–∏–µ                 | 4        | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –†–µ—à–µ–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–π –∑–∞–¥–∞—á–∏ (—Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è + –¥–µ—Ç–µ–∫—Ü–∏—è)                   | 4        | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å –∫–æ–º–±–∏–Ω–∞—Ü–∏–µ–π –±–æ–ª–µ–µ —á–µ–º –∏–∑ –æ–¥–Ω–æ–≥–æ –ª–æ—Å—Å–∞ (—Å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º) | 4        | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ                                             | 1        | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–º–æ-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ Streamlit –∏–ª–∏ Gradio                       | 4        | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –í—ã–≤–æ–¥—ã –ø–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é                                                   | 2        | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| –ß–∏—Å—Ç–æ—Ç–∞ –∫–æ–¥–∞ –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ—Å—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è                       | 2        | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
| **–ò—Ç–æ–≥–æ**                                                                | **24**   | ‚Äî         |

> **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:** `from ultralytics import YOLO` –≤ –æ–±—É—á–µ–Ω–∏–∏ = –¥–∏—Å–∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è (–∏—Å–∫–ª—é—á–µ–Ω–∏–µ ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏, —Å–º. –¢–ó).

---

## –í—ã–≤–æ–¥—ã –ø–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

1. **–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è vs –î–µ—Ç–µ–∫—Ü–∏—è:** –î–ª—è –∑–∞–¥–∞—á–∏ –æ—Ü–µ–Ω–∫–∏ –ø–ª–æ—â–∞–¥–∏ –∑–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è (UNet) –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –¥–µ—Ç–µ–∫—Ü–∏–µ–π (Faster R-CNN):
   - UNet: IoU 73.71%, MAPE 6.13%
   - Faster R-CNN: mAP 47.79%

2. **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ loss-—Ñ—É–Ω–∫—Ü–∏–∏:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ BCE+Dice loss –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –±–æ—Ä–æ—Ç—å—Å—è —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤ (—Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ñ–æ–Ω:–∑–¥–∞–Ω–∏—è ~ 5:1) –∏ —É–ª—É—á—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –≥—Ä–∞–Ω–∏—Ü —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏.

3. **–í–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –≥–æ—Ä–æ–¥–∞–º:** –ö–∞—á–µ—Å—Ç–≤–æ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤–∞—Ä—å–∏—Ä—É–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –∑–∞—Å—Ç—Ä–æ–π–∫–∏ (–ø–æ –¥–∞–Ω–Ω—ã–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏):
   - –õ—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã: –ø–ª–æ—Ç–Ω–∞—è –≥–æ—Ä–æ–¥—Å–∫–∞—è –∑–∞—Å—Ç—Ä–æ–π–∫–∞ (Vienna, Tyrol-W) ‚Äî IoU ~79%
   - –•—É–¥—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã: —Å–µ–ª—å—Å–∫–∞—è –º–µ—Å—Ç–Ω–æ—Å—Ç—å (Kitsap) ‚Äî IoU 61%
   - *–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –æ—Ü–µ–Ω–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –≥–æ—Ä–æ–¥–∞—Ö (Bellingham, Bloomington, Innsbruck, San Francisco, Tyrol-E) –Ω–µ –ø—Ä–æ–≤–æ–¥–∏–ª–∞—Å—å*

4. **–û—Ü–µ–Ω–∫–∞ GSD:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ —Å –ø–æ–º–æ—â—å—é –Ω–µ–π—Ä–æ—Å–µ—Ç–∏, –Ω–æ —Ç–æ—á–Ω–æ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ (Median AE 26 —Å–º). –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ GeoTIFF –∏–ª–∏ —Ä—É—á–Ω–æ–π –≤–≤–æ–¥.

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ –¥–∞–Ω–Ω—ã—Ö —Å GSD 30 —Å–º/–ø–∏–∫—Å–µ–ª—å ‚Äî –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–∂–µ—Ç —Å–Ω–∏–∂–∞—Ç—å—Å—è –Ω–∞ —Å–Ω–∏–º–∫–∞—Ö —Å –¥—Ä—É–≥–∏–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º
- –°–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å –¥–µ—Ç–µ–∫—Ü–∏–µ–π –∑–¥–∞–Ω–∏–π, —á–∞—Å—Ç–∏—á–Ω–æ —Å–∫—Ä—ã—Ç—ã—Ö –¥–µ—Ä–µ–≤—å—è–º–∏
- –¢–µ–Ω–∏ –æ—Ç –≤—ã—Å–æ–∫–∏—Ö –∑–¥–∞–Ω–∏–π –º–æ–≥—É—Ç –æ—à–∏–±–æ—á–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –∑–¥–∞–Ω–∏—è

### –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–ª—É—á—à–µ–Ω–∏—è

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä (Swin Transformer, SegFormer)
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å —Ä–∞–∑–Ω—ã–º GSD –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∞–ª–∏–∑–∞—Ü–∏–∏
- Instance segmentation (Mask R-CNN) –¥–ª—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ø–æ–¥—Å—á—ë—Ç–∞ –∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∑–¥–∞–Ω–∏–π

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Core

| –ü–∞–∫–µ—Ç       | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                |
| ----------- | ------ | ------------------------- |
| Python      | 3.12+  | Runtime                   |
| PyTorch     | 2.9+   | Deep Learning framework   |
| torchvision | 0.24+  | Vision models, transforms |
| timm        | 1.0+   | Pretrained backbones      |

### Computer Vision

| –ü–∞–∫–µ—Ç          | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ        |
| -------------- | ------ | ----------------- |
| OpenCV         | 4.11+  | Image processing  |
| Albumentations | 2.0+   | Data augmentation |
| scikit-image   | 0.25+  | Image utilities   |
| rasterio       | 1.3+   | GeoTIFF I/O       |

### ML / Data Science

| –ü–∞–∫–µ—Ç        | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ        |
| ------------ | ------ | ----------------- |
| NumPy        | 2.3+   | Array operations  |
| Pandas       | 2.3+   | Data manipulation |
| scikit-learn | 1.8+   | Metrics           |

### Application

| –ü–∞–∫–µ—Ç           | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ    |
| --------------- | ------ | ------------- |
| Gradio          | 6.3+   | Web UI        |
| huggingface-hub | 1.2+   | Model hosting |

### Development

| –ü–∞–∫–µ—Ç  | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ         |
| ------ | ------ | ------------------ |
| pytest | 9.0+   | Testing            |
| ruff   | 0.14+  | Linting            |
| uv     | ‚Äî      | Package management |

---

## Acknowledgments

- [Deep Learning School](https://dls.samcs.ru/) (–ú–§–¢–ò) ‚Äî –∫—É—Ä—Å –ø–æ –≥–ª—É–±–æ–∫–æ–º—É –æ–±—É—á–µ–Ω–∏—é
- [Stepik](https://stepik.org/course/250969/) ‚Äî –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∫—É—Ä—Å–∞
- [INRIA Aerial Image Labeling Dataset](https://project.inria.fr/aerialimagelabeling/) ‚Äî –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
- [Lee & Sull, 2019](https://www.mdpi.com/2072-4292/11/19/2276) ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Regression Tree CNN –¥–ª—è –æ—Ü–µ–Ω–∫–∏ GSD

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

Copyright (c) 2025

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
